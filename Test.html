<!DOCTYPE html>
<html>
<head>
  <link rel="stylesheet" type="text/css" href="Test.css">
  <title>Test Amphit</title>
  <style>
    /* ... stili CSS ... */
  </style>
</head>
<body>
  <div class="container">
    <!-- ... codice HTML ... -->

    <div class="raffle">
      <!-- ... codice HTML ... -->

      <input type="number" id="ticketInput" placeholder="Numero di biglietti">
      <button id="partecipaButton" onclick="participateRaffle()">Partecipa</button>

      <!-- ... codice HTML ... -->

      <div id="alert" style="display: none;"></div>
    </div>
  </div>

  <script>
    var totalTickets = 140; // Numero totale di biglietti disponibili
    var maxTickets = Math.floor(totalTickets * 0.1); // Limite massimo del 10% dei biglietti
    var ticketCount = 0; // Contatore dei biglietti acquistati

    function showAlert(message) {
      var alertElement = document.querySelector('#alert');
      alertElement.textContent = message;
      alertElement.style.display = 'block';
    }

    function updateTicketCount() {
      var totalTicketsElement = document.querySelector('#totalTickets');
      var remainingTicketsElement = document.querySelector('#remainingTickets');
      var progressBarElement = document.querySelector('.ticket-progress');

      var remainingTickets = totalTickets - ticketCount;
      var progressPercentage = (remainingTickets / totalTickets) * 100;

      totalTicketsElement.textContent = totalTickets;
      remainingTicketsElement.textContent = remainingTickets;
      progressBarElement.style.width = progressPercentage + '%';

      if (ticketCount === totalTickets) {
        disableTicketPurchase();
      }
    }

    function disableTicketPurchase() {
      var ticketInput = document.querySelector('#ticketInput');
      var participateButton = document.querySelector('#partecipaButton');

      ticketInput.disabled = true;
      participateButton.disabled = true;
    }

    function participateRaffle() {
      var ticketInput = document.querySelector('#ticketInput');
      var tickets = parseInt(ticketInput.value);

      if (tickets > 0 && tickets <= maxTickets) {
        if (ticketCount + tickets > totalTickets) {
          var insufficientTicketsMessage = 'Non ci sono abbastanza biglietti disponibili.';
          showAlert(insufficientTicketsMessage);
          return;
        }

        for (var i = 0; i < tickets; i++) {
          ticketCount++; // Incrementa il contatore dei biglietti
          // Codice per assegnare e numerare il biglietto (ad esempio, salvare in un database o creare un elemento HTML)
        }

        var successMessage = 'Grazie per aver partecipato alla raffle! Hai acquistato ' + tickets + ' biglietti.';
        showAlert(successMessage);
        ticketInput.value = '';

        updateTicketCount(); // Aggiorna il numero dei biglietti rimanenti e la barra di avanzamento
      } else {
        var invalidTicketsMessage = 'Inserisci un numero di biglietti valido (superiore a 0 e massimo ' + maxTickets + ').';
        showAlert(invalidTicketsMessage);
      }
    }

    window.onload = function() {
      var ticketInput = document.querySelector('#ticketInput');
      var alertElement = document.querySelector('#alert');
      
      ticketInput.addEventListener('input', function() {
        var tickets = parseInt(ticketInput.value);

        if (tickets <= 0 || tickets > maxTickets) {
          ticketInput.value = ''; // Resetta il valore se non Ã¨ valido
        }
      });

      alertElement.addEventListener('click', function() {
        alertElement.style.display = 'none';
      });

      updateTicketCount(); // Inizializza il numero dei biglietti rimanenti

      if (ticketCount === totalTickets) {
        disableTicketPurchase();
      }
    }
  </script>
</body>
</html>
